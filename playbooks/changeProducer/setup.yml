---

- hosts: all
  become: true
  become_user: ubuntu
  environment:
    GOPATH: "/home/ubuntu/go"
    GOROOT: "/usr/local/go"
    PATH: "/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/go/bin:/home/ubuntu/go/bin"

  tasks:
#################### update genesis.conf ####################
  - name: Remove genesis.conf
    shell: 'rm -r genesis.conf'
    args:
      chdir: /home/ubuntu/go/src/github.com/dappley/go-dappley/dapp/conf

  - name: Create genesis.conf
    shell: '> genesis.conf'
    args:
      chdir: /home/ubuntu/go/src/github.com/dappley/go-dappley/dapp/conf

  - name: Update genesis.conf
    lineinfile:
      path: /home/ubuntu/go/src/github.com/dappley/go-dappley/dapp/conf/genesis.conf
      state: present
      line: "{{ item }}"
    with_items:
    - 'producers: ['
    - '"dastXXWLe5pxbRYFhcyUq8T3wb5srWkHKa",'
    - '"dUuPPYshbBgkzUrgScEHWvdGbSxC8z4R12",'
    - '"dPGD4t6ibpmyKZnXH1TNbbPw98EDaaZq8C",'
    - '"dUa6gQkijmVqf7pk9cmRS6M9nMnU6b9Ssm",'
    - '"dTSNWQeFNRJBEQEhuDJNdu219r389CSkh3"'
    - ']'
    - 'max_producers: 5'